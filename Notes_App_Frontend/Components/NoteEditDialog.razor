@using MudBlazor
@using Notes_App_Frontend.Models
@using Notes_App_Frontend.Pages
@using Notes_App_Frontend.Service
@inject INoteService NoteService
@inject ISnackbar Snackbar;


<MudDialog>
    <TitleContent>
        <MudText Typo="Typo.h6">
            @Note.Title
        </MudText>
    </TitleContent>
    
    <DialogContent>

        <MudTextField T="string" Label="Multiline" Variant="Variant.Text" @bind-Value="@Note.Text" Lines="20" />
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="Cancel">Cancel</MudButton>
        <MudButton Color="Color.Error" OnClick="SaveChanges">Save</MudButton>
    </DialogActions>
</MudDialog>

@code {
    
    [CascadingParameter] MudDialogInstance MudDialog { get; set; }
    [Parameter]
    public Note Note { get; set; }

    
    private void Cancel()
    {
        MudDialog.Cancel();
    }

    private async void SaveChanges()
    {
        var saveResult = await NoteService.SaveNote(Note);
        if (saveResult.ID.Length == 0)
        {
            Snackbar.Add("Note don't save!", Severity.Error);
        }
        else
        {
            Snackbar.Add("Note saved!", Severity.Success);
            Note = saveResult;
        } 
        //MudDialog.Close(DialogResult.Ok(true));
    }
    
}